{% extends base_template %}

{% block content %}
    <div id="applications">
        Forms for Application
        <select>
            {% for application in applications %}
            <option value="{% url hqui.views.forms domain application.name %}"
                    {% ifequal application.name app.name %}selected{% endifequal %}>
                {{ application.name }}
            </option>
            {% endfor %}
        </select>
        <a class="button" id="new_app" href="#">New Application...</a>
        <div id="new_app_dialog" title="Create a New Application">
            <form action="{% url hqui.views.new_app domain %}" method="post">
                <table>
                    {{ new_app_form.as_table }}
                </table>
                <input type="submit" value="Create Application"/>
            </form>

        </div>

    </div>
    <div id="form-tabs">
        <ul>
            <li><a href='#forms'>Forms</a></li>
            <li><a href='#settings'>Settings</a></li>
            <li><a href='#release'>Release</a></li>
        </ul>
        <div id="forms">
            <div>
                <div id="modules">
                    {% with module as selected_module %}
                    {% for module in app.modules %}
                    <h2 {% ifequal module selected_module %} class="selected"{% endifequal %}>
                        {{ module.name }}
                        [<a href="{% url hqui.views.new_form domain app.name module.name %}"
                            >+</a>]
                    </h2>
                    <ul {% ifequal module selected_module %} class="selected"{% endifequal %}>
                        {% with form as selected_form %}
                        {% for form in module.forms %}
                        <li {% ifequal form selected_form %} class="selected"{% endifequal %}>
                            <a href="{% url hqui.views.forms domain app.name module.name form.name %}">{{ form.name }}</a>
                        </li>
                        {% endfor %}
                        {% endwith %}
                    </ul>
                    {% endfor %}
                    {% endwith %}
                    <a class="button" href="#" id="new_module">New Module...</a>
                    <div id="new_module_dialog" title="Create New Module">
                        <form action="{% url hqui.views.new_module domain app.name %}" method="post">
                            <table>
                                {{ new_module_form.as_table }}
                            </table>
                            <input type="submit" value="Create Module" />
                        </form>

                    </div>
                </div>
                <div id="form-view">
                    {% block form-view %}
                    {% if form %}
                    <h3>{% if module %}{{ module.name }} &gt; {% endif %}{{ form.name }}</h3>
                    {% if xform%}
                        ({{ xform.xmlns }})
                        <!--pre>{{ xform_contents }}</pre-->
                        <pre class="code"><code class="xml">{{ xform_contents }}</code></pre>
                        <a class="button" href="{% url hqui.views.delete_form domain app.name module.name form.name %}">
                            Delete Form
                        </a>
                    {% else %}
                        <p>This xform doesn't seem to exist. Would you like to create one with this name?</p>
                        <a class="button" href="{% url hqui.views.new_form domain app.name module.name %}?form_name={{ form.name }}">Create Form</a>

                    {% endif %}
                    {% endif %}
                    {% endblock %}
                </div>
            </div>
        </div>
        <div id="settings"></div>
        <div id="release"></div>
    </div>
{% endblock %}